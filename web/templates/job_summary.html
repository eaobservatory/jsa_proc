{% extends 'layout.html' %}

{% block content %}

<h2>There are {{ total_count }} jobs in the database
{% if date_min is not none or date_max is not none %}
from {{date_min}} to {{date_max}}
{% endif %}
</h2>

<h2>Summary table</h2>

<div>
  <div class="col">
    <table>
      <tr>
        <th>State</th>
        {% for l in locations %}
        <th>{{ l }}</th>
        {% endfor %}
      </tr>
      {% for s, value in job_summary_dict.items() %}
      <tr>
        <td class="state_{{ s | state_phase}}"><a href="{{ url_for('job_list', state=s, task=task) }}">{{ s | state_name }}</a></td>
        {% for l, numb  in value.items() %}
        <td><a href="{{ url_for('job_list', location=l, state=s, task=task) }}">{{ numb }}</a></td>
        {% endfor %}
      </tr>
      {% endfor %}
    </table>
  </div>

  <div class="col">
    <h4> All jobs </h4>
    <img src="{{ url_for('summary_piechart', task=task, stamp=stamp,date_min=date_min, date_max=date_max)}}" alt="pie chart" />
  </div>

</div>

<div class="clear"></div>

<div>
  <div class="col">
    <h4>Without pointings </h4>
    <img src="{{ url_for('summary_piechart', task=task, ObsTypes='Science',stamp=stamp,date_min=date_min, date_max=date_max)}}" alt="pie chart" />
  </div>
  <div class="col">
    <h4>Without pointings and calibrations </h4>
    <img src="{{ url_for('summary_piechart', task=task, ObsTypes='Science', CalTypes='NoCalibrations',stamp=stamp, date_min=date_min, date_max=date_max)}}" alt="pie chart" />
  </div>
</div>

{% endblock %}
